<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Authorize A</title>
</head>
<body>
  <script src="https://p.trellocdn.com/power-up.min.js"></script>

  <script>
    console.log('authorize.html LOADED vFINAL');

    const t = TrelloPowerUp.iframe();

    t.authorize({
      type: 'popup',
      name: 'Power-Up A',

      authorizeUrl: function (secret) {
        console.log('authorizeUrl called, secret=', secret);

        return (
          'https://trello.com/1/authorize' +
          '?expiration=never' +
          '&name=Power-Up%20A' +
          '&scope=read,write' +
          '&response_type=token' +
          '&key=2724c7e7d9e21b4245805125ff7f7c1a' +
          '&state=' + secret +
          '&return_url=' + encodeURIComponent(
            'https://rayandrialdy.github.io/powerupa/authorize-success.html'
          )
        );
      }
    })
    .then(function () {
      console.log('authorize SUCCESS');
      return t.closePopup();
    })
    .catch(function (err) {
      console.error('authorize FAILED', err);
    });
  </script>
</body>
</html>
