<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Authorize</title>
</head>
<body>
<script src="https://p.trellocdn.com/power-up.min.js"></script>
<script>
  const t = TrelloPowerUp.iframe();

  const API_KEY = '2724c7e7d9e21b4245805125ff7f7c1a';

  t.authorize({
    type: 'popup',
    name: 'My Power-Up',
    scope: {
      read: true,
      write: true
    },
    expiration: 'never',

    // ðŸ”‘ INI YANG TADI HILANG
    url: function (secret) {
      return (
        'https://trello.com/1/authorize' +
        '?expiration=never' +
        '&name=My%20Power-Up' +
        '&scope=read,write' +
        '&response_type=token' +
        '&key=' + API_KEY +
        '&return_url=' + encodeURIComponent(
          window.location.origin + '/powerupa/authorize-success.html'
        )
      );
    },

    success: function (token) {
      // âœ… TOKEN VALID
      return t
        .set('member', 'private', 'token', token)
        .then(() => t.closePopup());
    },

    error: function (err) {
      console.error('AUTH ERROR', err);
    }
  });
</script>
</body>
</html>
